<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0 from src/site/markdown/index.md at 2025-10-12
 | Rendered using Apache Maven Fluido Skin 2.1.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0" />
    <title>Overview – simple-pool</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.1.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.1.0.min.js"></script>
  </head>
  <body>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1>simple-pool</h1></div></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2025-10-12<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.0</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">simple-pool</li>
    <li class="active"><a>Overview</a></li>
    <li><a href="download.html">Download</a></li>
    <li><a href="https://github.com/robtimus/simple-pool/releases">Releases</a></li>
    <li><a href="apidocs/index.html">Javadoc</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">

<section><a id="simple-pool"></a>
<h1>simple-pool</h1>
<p>A simple object pool implementation. It is designed to be small and lightweight.</p>
<p>This library does not enforce an exception type like <code>IOException</code>, nor is it limited to only unchecked exceptions. Instead, each pool and its related classes have a generic type for the exception type that can be thrown. This allows callers to provide their own exception types. For cases where no exceptions are thrown, a marker exception type is provided: <a href="apidocs/com.github.robtimus.pool/com/github/robtimus/pool/None.html">None</a>.</p><section><a id="Creating_pools"></a>
<h2>Creating pools</h2>
<p>A pool needs 3 to 4 things:</p>
<ul>

<li>A type of object that can be pooled. This should be provided as a sub class of <a href="apidocs/com.github.robtimus.pool/com/github/robtimus/pool/PoolableObject.html">PoolableObject</a>.</li>
<li>Configuration for the pool. This includes the initial and maximum pool sizes.</li>
<li>A factory for creating pooled objects.</li>
<li>Optionally, a logger that will be triggered for specific events in the pool.</li>
</ul>
<p>Class <a href="apidocs/com.github.robtimus.pool/com/github/robtimus/pool/Pool.html">Pool</a> provides two factory methods that accept a <code>Supplier</code> instead of the factory, and use <code>None</code> as the exception type. For instance, where <code>MyObject</code> extends <code>PoolableObject&lt;None&gt;</code>:</p>

<pre class="prettyprint"><code class="language-java">Pool&lt;MyObject, None&gt; pool = Pool.throwingNone(config, MyObject::new, logger);
</code></pre><section><a id="PoolableObject"></a>
<h3>PoolableObject</h3>
<p><code>PoolableObject</code> is the base class for all object types that can be stored in a pool. Sub classes should implement <code>isValid</code> and <code>doReleaseResources</code>. In addition, they should provide a method that calls <code>release</code>. This method should be called to return the object to the pool. The <code>close</code> method of interface <code>AutoCloseable</code> or <code>Closeable</code> is a good candidate.</p>
<p>A <code>PoolableObject</code> can have other references added. Instances are only returned to the pool if all references have been removed. This can be used if the object can expose other objects like <code>InputStream</code> or <code>OutputStream</code>. By adding references to the poolable object and removing these references when the exposed objects are no longer necessary (e.g. when they are closed), it's possible to delay returning objects to the pool. This allows sub classes to be released without having to worry about these references themselves. For instance:</p>

<pre class="prettyprint"><code class="language-java">class MyConnection extends PoolableObject&lt;IOException&gt; {

    ...

    InputStream getInputStream() throws IOException {
        InputStream inputStream = ...;
        Reference&lt;IOException&gt; reference = addReference();
        // WrappingInputStream should be a class that extends InputStream and delegates to inputStream
        return new WrappingInputStream(inputStream, reference);
    }
}
</code></pre>
<p>In this example, when the <code>WrappingInputStream</code> instance is closed, it should first close <code>inputStream</code>, then remove the reference. To make this easy <code>Reference</code> is <code>AutoCloseable</code>, allowing a single try-with-resources block to be used. To make sure that the objects are closed in order, always put the reference first so it gets closed (removed) last:</p>

<pre class="prettyprint"><code class="language-java">try (reference; inputStream) {
    // This block will close inputStream first, reference second, and always close both
}
</code></pre></section><section><a id="Configuration"></a>
<h3>Configuration</h3>
<p>Class <a href="apidocs/com.github.robtimus.pool/com/github/robtimus/pool/PoolConfig.html">PoolConfig</a> can be used to provide configuration. It currently supports 4 settings:</p>
<ul>

<li>The initial size (default: 1) - the initial number of objects in the pool.</li>
<li>The maximum pool size (default: 5).</li>
<li>The maximum wait time (default: indefinitely) - if an object is acquired without an explicit wait time, this value will be used.</li>
<li>The maximum idle time (default: indefinitely) - any objects that have been in the pool longer than this time will be removed from the pool.</li>
</ul>
<p>When acquiring objects from the pool, an idle object will be used if available. Otherwise, if the current pool size is smaller than the maximum, a new object will be created.</p></section><section><a id="Factory"></a>
<h3>Factory</h3>
<p>Interface <a href="apidocs/com.github.robtimus.pool/com/github/robtimus/pool/PoolableObjectFactory.html">PoolableObjectFactory</a> is a functional interface similar to <code>Supplier</code> that is used to create new objects. It shares the exception type it can throw with the <code>PoolableObject</code> instances it can create.</p></section><section><a id="Logger"></a>
<h3>Logger</h3>
<p>Class <a href="apidocs/com.github.robtimus.pool/com/github/robtimus/pool/PoolLogger.html">PoolLogger</a> can be used to provide logging. It uses SLF4J for this; if it is not available on the class path logging will be disabled.
A pool logger can use a custom logger name, log message prefix or object prefix. This allows you to customize the logging somewhat. For instance, with log message prefix <code>ftp.example.org -</code> and object prefix <code>connection-</code>, a message could look like this:</p>

<pre><code class="nohighlight nocode">ftp.example.org - Acquired object 'connection-4' from pool; idle: 2, pool size: 5
</code></pre></section></section><section><a id="Using_pools"></a>
<h2>Using pools</h2>
<p>A pool only has a few methods:</p>
<ul>

<li><code>acquire</code> will return an object from the pool, blocking until one is available. The method is overloaded to provide the wait timeout, as well as the exception that is thrown when the timeout expires.</li>
<li><code>acquireNow</code> will return an object from the pool, wrapped in an <code>Optional</code>. If no object is available immediately, an empty <code>Optional</code> is returned instead.</li>
<li><code>acquireOrCreate</code> will return an object from the pool. If no object is available immediately, a new non-pooled object is created instead. This can be used in case an object is needed (so <code>acquireNow</code> cannot be used), but blocking may cause deadlock or similar issues. In these cases, it's usually better to just use a disposable object.</li>
<li><code>forAllIdleObjects</code> will internally acquire all idle objects, perform an operation on them, and then return them to the pool. This can for instance be used to send keep-alive signals to all idle objects.</li>
<li><code>shutdown</code> will release the resources of all idle objects, remove them, and prevent any other operation on the pool. Any call to <code>acquire</code> that is blocked will throw an <code>IllegalStateException</code>. This can be used to cleanup all resources.</li>
<li><code>isActive</code> can be used to query the state of the pool. It will return <code>true</code> until <code>shutdown</code> is called.</li>
</ul>
<p>An acquired object should eventually be released. It is up to the <code>PoolableObject</code> sub class to expose the <code>release</code> method, either by overriding it and making it public, or by calling it from a different public method like <code>close</code>.</p>
<p>For instance, assuming <code>MyObject</code> extends <code>PoolableObject&lt;IOException&gt;</code>, implements <code>AutoCloseable</code>, and calls <code>release</code> from its <code>close</code> method:</p>

<pre class="prettyprint"><code class="language-java">Pool&lt;MyObject, IOException&gt; pool = new Pool&lt;&gt;(config, MyObject::new, logger);
try (MyObject object = pool.acquire()) { // note: may throw InterruptedException
    // use object as needed
}
// object.close() will have called object.release(), which means object has been returned to the pool
</code></pre><section><a id="ObjectWrapper"></a>
<h3>ObjectWrapper</h3>
<p>To make it easy to create pools of objects that are always valid and don't need any resource cleanup, class <a href="apidocs/com.github.robtimus.pool/com/github/robtimus/pool/ObjectWrapper.html">ObjectWrapper</a> is a <code>PoolableObject</code> sub class that simply wraps a value. It implements <code>AutoCloseable</code>, so it can be used in try-with-resources blocks:</p>

<pre class="prettyprint"><code class="language-java">Pool&lt;ObjectWrapper&lt;MyObject&gt;, None&gt; pool = ObjectWrapper.newPool(config, MyObject::new, logger);
try (ObjectWrapper&lt;MyObject&gt; wrapper = pool.acquire()) { // note: may throw InterruptedException
    MyObject object = wrapper.value();
    // use object as needed
}
// wrapper.close() will have returned the wrapper to the pool
</code></pre></section></section></section>        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2022–2025
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
